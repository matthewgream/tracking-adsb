// ------------------------------------------------------------------------------------------------------------------------------------------------------------
// ------------------------------------------------------------------------------------------------------------------------------------------------------------

const SEVERITY_LEVELS = {
    critical: 4,
    high: 3,
    medium: 2,
    low: 1,
    info: 0,
};

function getHighestSeverity(items, severityField = 'severity') {
    if (!items || items.length === 0) return 'info';

    return items.reduce((highest, item) => {
        const itemSeverity = item[severityField];
        return SEVERITY_LEVELS[itemSeverity] > SEVERITY_LEVELS[highest] ? itemSeverity : highest;
    }, 'info');
}

function compareSeverity(a, b, severityField = 'severity') {
    return SEVERITY_LEVELS[b[severityField]] - SEVERITY_LEVELS[a[severityField]];
}

// ------------------------------------------------------------------------------------------------------------------------------------------------------------
// ------------------------------------------------------------------------------------------------------------------------------------------------------------

module.exports = {
    //
    SEVERITY_LEVELS,
    compareSeverity,
    getHighestSeverity,
};

// ------------------------------------------------------------------------------------------------------------------------------------------------------------
// ------------------------------------------------------------------------------------------------------------------------------------------------------------
